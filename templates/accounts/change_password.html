{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="section-content padding-y">
  <div class="container">
    <div class="row">
      <!-- Sidebar -->
      <aside class="col-md-3">
        <nav class="list-group card">
          <a class="list-group-item" href="{% url 'accounts:dashboard' %}">
            <i class="fas fa-user-circle me-2"></i> My Dashboard
          </a>
          <a class="list-group-item" href="{% url 'accounts:edit_profile' %}">
            <i class="fas fa-user-edit me-2"></i> Edit Profile
          </a>
          <a class="list-group-item active" href="{% url 'accounts:change_password' %}">
            <i class="fas fa-key me-2"></i> Change Password
          </a>
          <a class="list-group-item" href="{% url 'cart' %}">
            <i class="fas fa-shopping-cart me-2"></i> My Cart
          </a>
          <a class="list-group-item" href="{% url 'accounts:account_statistics' %}">
            <i class="fas fa-chart-bar me-2"></i> Account Statistics
          </a>
          <a class="list-group-item" href="{% url 'store' %}">
            <i class="fas fa-shopping-bag me-2"></i> Continue Shopping
          </a>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="col-md-9">
        <article class="card">
          <header class="card-header bg-warning text-white">
            <strong class="d-inline-block mr-3">
              <i class="fas fa-key me-2"></i>Change Password
            </strong>
          </header>
          <div class="card-body">
            <form action="{% url 'accounts:change_password' %}" method="POST">
              {% csrf_token %}
              
              <div class="row">
                <div class="col-md-12 mb-3">
                  <label for="id_current_password">Current Password</label>
                  {{ form.current_password }}
                  {% if form.current_password.errors %}
                    <div class="text-danger small mt-1">
                      {% for error in form.current_password.errors %}
                        {{ error }}<br>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="id_new_password">New Password</label>
                  {{ form.new_password }}
                  {% if form.new_password.errors %}
                    <div class="text-danger small mt-1">
                      {% for error in form.new_password.errors %}
                        {{ error }}<br>
                      {% endfor %}
                    </div>
                  {% endif %}
                  <small class="text-muted">Password must be at least 8 characters long.</small>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="id_confirm_password">Confirm New Password</label>
                  {{ form.confirm_password }}
                  {% if form.confirm_password.errors %}
                    <div class="text-danger small mt-1">
                      {% for error in form.confirm_password.errors %}
                        {{ error }}<br>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
              </div>

              {% if form.non_field_errors %}
                <div class="alert alert-danger">
                  {% for error in form.non_field_errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}

              <div class="alert alert-info">
                <i class="fas fa-info-circle me-2"></i>
                <strong>Note:</strong> After changing your password, you'll remain logged in.
              </div>

              <div class="mt-4">
                <button type="submit" class="btn btn-warning">
                  <i class="fas fa-key me-2"></i>Change Password
                </button>
                <a href="{% url 'accounts:dashboard' %}" class="btn btn-secondary">
                  <i class="fas fa-times me-2"></i>Cancel
                </a>
              </div>
            </form>
          </div>
        </article>
      </main>
    </div>
  </div>
</section>
{% endblock %}

