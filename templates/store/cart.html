{% extends 'base.html' %}

{% load static %}

{% block content %}

<!-- ========================= SECTION CONTENT ========================= -->
<section class="section-content padding-y bg">
<div class="container">

<!-- ============================ COMPONENT 1 ================================= -->
<div class="row">
	<aside class="col-lg-9">
		<div class="card">
			<table class="table table-borderless table-shopping-cart">
				<thead class="text-muted">
					<tr class="small text-uppercase">
						<th scope="col">Product</th>
						<th scope="col" width="120">Quantity</th>
						<th scope="col" width="120">Price</th>
						<th scope="col" class="text-right" width="200"> </th>
					</tr>
				</thead>
				<tbody>
					{% if cart_items %}
						{% for cart_item in cart_items %}
						<tr>
							<td>
								<figure class="itemside align-items-center">
									<div class="aside">
										{% if cart_item.product.images and cart_item.product.images.name %}
											<img src="{{ cart_item.product.images.url }}" class="img-sm" alt="{{ cart_item.product.product_name }}">
										{% elif cart_item.product.product_images.all %}
											{% with first_image=cart_item.product.product_images.all|first %}
												<img src="{{ first_image.image.url }}" class="img-sm" alt="{{ cart_item.product.product_name }}">
											{% endwith %}
										{% else %}
											<img src="{% static 'images/placeholder.jpg' %}" class="img-sm" alt="{{ cart_item.product.product_name }}" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'100\' height=\'100\'%3E%3Crect fill=\'%23f0f0f0\' width=\'100\' height=\'100\'/%3E%3Ctext fill=\'%23999\' font-family=\'sans-serif\' font-size=\'12\' dy=\'10.5\' font-weight=\'bold\' x=\'50%25\' y=\'50%25\' text-anchor=\'middle\'%3ENo Image%3C/text%3E%3C/svg%3E';">
										{% endif %}
									</div>
								<figcaption class="info">
									<a href="{% url 'product_detail' cart_item.product.slug %}" class="title text-dark">{{ cart_item.product.product_name }}</a>
									<p class="text-muted small">{{ cart_item.product.category.Category_name }}</p>
									{% if cart_item.variations.all %}
										<p class="text-muted small mb-0">
											{% for variation in cart_item.variations.all %}
												<span class="badge badge-light border mr-1">{{ variation.variation_category|title }}: {{ variation.variation_value|title }}</span>
											{% endfor %}
										</p>
									{% endif %}
								</figcaption>
								</figure>
							</td>
							<td> 
								<div class="col"> 
									<div class="input-group input-spinner">
										<div class="input-group-prepend">
											<a href="{% url 'remove_cart_item' cart_item.product.id cart_item.id %}" class="btn btn-light" type="button"> <i class="fa fa-minus"></i> </a>
										</div>
										<input type="text" class="form-control" value="{{ cart_item.quantity }}" readonly>
										<div class="input-group-append">
											<a href="{% url 'add_cart' cart_item.product.id %}" class="btn btn-light" type="button"> <i class="fa fa-plus"></i> </a>
										</div>
									</div> <!-- input-group.// -->
								</div> <!-- col.// -->
							</td>
							<td> 
								<div class="price-wrap"> 
									<var class="price">₹{{ cart_item.sub_total }}</var> 
									<small class="text-muted"> ₹{{ cart_item.product.price }} each </small> 
								</div> <!-- price-wrap .// -->
							</td>
							<td class="text-right"> 
								<a href="{% url 'remove_cart' cart_item.product.id cart_item.id %}" class="btn btn-danger"> Remove</a>
							</td>
						</tr>
						{% endfor %}
					{% else %}
						<tr>
							<td colspan="4" class="text-center">
								<h5>Your cart is empty</h5>
								<a href="{% url 'store' %}" class="btn btn-primary mt-3">Continue Shopping</a>
							</td>
						</tr>
					{% endif %}
				</tbody>
			</table>
		</div> <!-- card.// -->
	</aside> <!-- col.// -->
	
	<aside class="col-lg-3">
		<div class="card">
			<div class="card-body">
				<dl class="dlist-align">
					<dt>Total (GST included):</dt>
					<dd class="text-right text-dark b"><strong>₹{{ grand_total|floatformat:2 }}</strong></dd>
				</dl>
				<hr>
				<p class="text-center mb-3">
					<img src="{% static 'images/misc/payments.png' %}" height="26">
				</p>
				<a href="{% url 'checkout' %}" class="btn btn-primary btn-block"> Checkout </a>
				<a href="{% url 'store' %}" class="btn btn-light btn-block">Continue Shopping</a>
			</div> <!-- card-body.// -->
		</div> <!-- card.// -->
	</aside> <!-- col.// -->
</div> <!-- row.// -->
<!-- ============================ COMPONENT 1 END .// ================================= -->

</div> <!-- container .//  -->
</section>
<!-- ========================= SECTION CONTENT END// ========================= -->

{% endblock %}
